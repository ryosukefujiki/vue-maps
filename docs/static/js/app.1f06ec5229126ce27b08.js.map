{"version":3,"sources":["webpack:///./src/helpers/dom.js","webpack:///./src/helpers/mouse.js","webpack:///src/components/VueBlock.vue","webpack:///./src/components/VueBlock.vue?6f44","webpack:///./src/components/VueBlock.vue","webpack:///src/components/VueLink.vue","webpack:///./src/components/VueLink.vue?1c21","webpack:///./src/components/VueLink.vue","webpack:///src/components/VueBlocksContainer.vue","webpack:///./src/components/VueBlocksContainer.vue?366c","webpack:///./src/components/VueBlocksContainer.vue","webpack:///./src/components/VueBlockProperty.vue?afbd","webpack:///./src/components/VueBlockProperty.vue","webpack:///src/App.vue","webpack:///src/components/VueBlockProperty.vue","webpack:///./src/App.vue?7c73","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["getOffsetRect","element","box","getBoundingClientRect","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","top","left","Math","round","dom","helpers_mouse","getMousePosition","event","mouseX","pageX","clientX","document","documentElement","mouseY","pageY","clientY","offset","x","y","VueBlock","Number","Boolean","String","Array","Object","width","lastMouseX","lastMouseY","diffY","srcElement","preventDefault","save","index","scale","components_VueBlock","render","_vm","this","_h","$createElement","_c","_self","staticClass","class","selected","style","_v","_s","title","on","click","deleteBlock","_l","slot","active","mouseup","$event","slotMouseUp","mousedown","slotBreak","label","slotMouseDown","staticRenderFns","src_components_VueBlock","__webpack_require__","normalizeComponent","ssrContext","VueLink","y1","y2","t","_this","outlineStyle","pathes","_this2","PI","degrees","stroke","arrows","components_VueLink","attrs","height","p","d","data","_e","a","transform","VueBlocksContainer","VueLink_normalizeComponent","importBlocksContent","importScene","inputSlotClassName","centerX","centerY","originID","targetID","link","id","x1","x2","_step","value","tempLink","lines","e","diffX","deselectAll","updateScene","deltaScale","minScale","maxScale","deltaOffsetX","deltaOffsetY","titleHeight","isInput","block","outputs","length","slotNumber","originSlot","linkID","nodeName","name","field","newField","inputs","values","selectedBlock","_this3","_this4","s","b","newBlocks","blocksContent","_this5","scene","blocks","links","container","exportScene","components_VueBlocksContainer","_b","key","options","optionsForChild","update","linkingStart","linkingStop","linkingBreak","select","blockSelect","delete","blockDelete","components_VueBlockProperty","for","directives","rawName","expression","type","domProps","input","target","composing","$set","App","VueBlocksContainer_normalizeComponent","VueBlockProperty","VueBlockProperty_normalizeComponent","property","properties","loadProperties","family","selectedType","val","focus","contextMenu","containerElRect","largestWidth","largestHeight","$el","closeContextMenu","newValue","selectortype_template_index_0_src_App","ref","update:scene","selectBlock","blockDeselect","deselectBlock","nativeOn","contextmenu","showContextMenu","selectedBlockProperty","saveProperty","change","$$selectedVal","prototype","filter","call","o","map","_value","multiple","filteredBlocks","stopPropagation","addBlock","checked","isArray","useContextMenu","_i","$$a","$$el","$$c","$$i","concat","slice","tabindex","blur","addBlockContextMenu","src_App","App_normalizeComponent","vue_esm","config","productionTip","el","components","template"],"mappings":"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,cAEA,kBAEA,cACA,iBACA,cAEA,kBAEA,YACA,aAEA,eAEA,YACA,aAEA,eAEA,cACA,aAEA,gBAEA,cACA,aAIA,kBAEA,kBACA,mBACA,yBACA,+BAGA,kBACA,iBACA,iBAEA,kBAEA,YACA,aAEA,eAEA,YACA,aAEA,eAEA,aACA,aAIA,kBAEA,sBACA,qBACA,iBAGA,gBACA,0BACA,cAEA,kBAEA,iBACA,aAIA,kBAEA,cACA,eACA,mBACA,iBAGA,cACA,iBACA,cACA,iBAEA,SAEA,aACA,aAEA,eAEA,cACA,aAIA,kBAEA,kBACA,mBACA,qBACA,8CAGA,aACA,uBACA,YAEA,kBAEA,eACA,aAIA,kBAEA,iBACA,kBACA,sBACA,8CAGA,aACA,aAEA,eAEA,cACA,aAEA,gBAEA,cACA,aAEA,gBAEA,cACA,aAEA,gBAEA,cACA,aAKA,gCAIA,KACA,OACA,QACA,qBACA,uCAIA,eAKA,iBAEA,KACA,OACA,UACA,aACA,qCAIA,YAKA,iBAEA,IACA,OACA,UACA,aACA,qCAIA,YAKA,iBAEA,KACA,OACA,UACA,cACA,uCAIA,iBACA,eAKA,UAEA,KACA,MACA,UACA,kBACA,0CAIA,uBAKA,eAEA,KACA,MACA,UACA,aACA,qCAIA,YAKA,iBAEA,KACA,MACA,WACA,cACA,uCAIA,iBACA,eAKA,UAEA,KACA,MACA,WACA,aACA,qCAIA,YAKA,iBAEA,MACA,MACA,WACA,kBACA,0CAIA,uBAKA,eAEA,MACA,MACA,WACA,cACA,uCAIA,iBACA,eAKA,UAEA,MACA,MACA,WACA,aACA,qCAIA,YAKA,iBAEA,KACA,MACA,WACA,aACA,qCAIA,YAKA,iBAEA,MACA,MACA,WACA,cACA,uCAIA,iBACA,eAKA,UAEA,KACA,MACA,WACA,kBACA,+CAIA,iBAKA,oBAEA,KACA,KACA,WACA,cACA,uCAIA,iBACA,eAMA,kBAGA,WACA,aACA,WACA,aAEA,OAEA,WACA,aACA,WACA,aAEA,OAEA,WACA,aACA,WACA,aAEA,OAEA,WACA,aACA,WACA,cAEA,OAEA,WACA,aACA,WACA,aAEA,O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","file":"static/js/app.1f06ec5229126ce27b08.js","sourcesContent":["/**\n * @param element {HTMLElement}\n * @return {{top: number, left: number}}\n */\nexport function getOffsetRect (element) {\n  let box = element.getBoundingClientRect()\n\n  let scrollTop = window.pageYOffset\n  let scrollLeft = window.pageXOffset\n\n  let top = box.top + scrollTop\n  let left = box.left + scrollLeft\n\n  return {top: Math.round(top), left: Math.round(left)}\n}\n\nexport default {\n  getOffsetRect\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/dom.js","import {getOffsetRect} from './dom'\n\n/**\n * @param event {MouseEvent}\n * @param element {HTMLElement}\n * @return {{x: number, y: number}}\n */\nexport function getMousePosition (element, event) {\n  let mouseX = event.pageX || event.clientX + document.documentElement.scrollLeft\n  let mouseY = event.pageY || event.clientY + document.documentElement.scrollTop\n\n  let offset = getOffsetRect(element)\n  let x = mouseX - offset.left\n  let y = mouseY - offset.top\n\n  return {\n    x: x,\n    y: y\n  }\n}\n\nexport default {\n  getMousePosition\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/mouse.js","<template>\n  <div class=\"vue-block\" :class=\"{selected: selected}\" :style=\"style\">\n    <header :style=\"headerStyle\">\n      {{title}}\n      <a class=\"delete\" @click=\"deleteBlock\">x</a>\n    </header>\n    <div class=\"inputs\">\n      <div class=\"input\" v-for=\"(slot, index) in inputs\">\n        <div class=\"circle inputSlot\" :class=\"{active: slot.active}\"\n             @mouseup=\"slotMouseUp($event, index)\"\n             @mousedown=\"slotBreak($event, index)\"></div>\n        {{slot.label}}\n      </div>\n    </div>\n    <div class=\"outputs\">\n      <div class=\"output\" v-for=\"(slot, index) in outputs\">\n        <div class=\"circle\" :class=\"{active: slot.active}\"\n             @mousedown=\"slotMouseDown($event, index)\"></div>\n        {{slot.label}}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'VueBlock',\n    props: {\n      x: {\n        type: Number,\n        default: 0,\n        validator: function (val) {\n          return typeof val === 'number'\n        }\n      },\n      y: {\n        type: Number,\n        default: 0,\n        validator: function (val) {\n          return typeof val === 'number'\n        }\n      },\n      selected: Boolean,\n      title: {\n        type: String,\n        default: 'Title'\n      },\n      inputs: Array,\n      outputs: Array,\n\n      options: {\n        type: Object\n      }\n    },\n    created () {\n      this.mouseX = 0\n      this.mouseY = 0\n\n      this.lastMouseX = 0\n      this.lastMouseY = 0\n\n      this.linking = false\n      this.dragging = false\n    },\n    mounted () {\n      document.documentElement.addEventListener('mousemove', this.handleMove, true)\n      document.documentElement.addEventListener('mousedown', this.handleDown, true)\n      document.documentElement.addEventListener('mouseup', this.handleUp, true)\n    },\n    beforeDestroy () {\n      document.documentElement.removeEventListener('mousemove', this.handleMove, true)\n      document.documentElement.removeEventListener('mousedown', this.handleDown, true)\n      document.documentElement.removeEventListener('mouseup', this.handleUp, true)\n    },\n    data () {\n      return {\n        width: this.options.width,\n        hasDragged: false\n      }\n    },\n    methods: {\n      handleMove (e) {\n        this.mouseX = e.pageX || e.clientX + document.documentElement.scrollLeft\n        this.mouseY = e.pageY || e.clientY + document.documentElement.scrollTop\n\n        if (this.dragging && !this.linking) {\n          let diffX = this.mouseX - this.lastMouseX\n          let diffY = this.mouseY - this.lastMouseY\n\n          this.lastMouseX = this.mouseX\n          this.lastMouseY = this.mouseY\n\n          this.moveWithDiff(diffX, diffY)\n\n          this.hasDragged = true\n        }\n      },\n      handleDown (e) {\n        this.mouseX = e.pageX || e.clientX + document.documentElement.scrollLeft\n        this.mouseY = e.pageY || e.clientY + document.documentElement.scrollTop\n\n        this.lastMouseX = this.mouseX\n        this.lastMouseY = this.mouseY\n\n        const target = e.target || e.srcElement\n        if (this.$el.contains(target) && e.which === 1) {\n          this.dragging = true\n\n          this.$emit('select')\n\n          if (e.preventDefault) e.preventDefault()\n        }\n      },\n      handleUp () {\n        if (this.dragging) {\n          this.dragging = false\n\n          if (this.hasDragged) {\n            this.save()\n            this.hasDragged = false\n          }\n        }\n\n        if (this.linking) {\n          this.linking = false\n        }\n      },\n      // Slots\n      slotMouseDown (e, index) {\n        this.linking = true\n\n        this.$emit('linkingStart', index)\n        if (e.preventDefault) e.preventDefault()\n      },\n      slotMouseUp (e, index) {\n        this.$emit('linkingStop', index)\n        if (e.preventDefault) e.preventDefault()\n      },\n      slotBreak (e, index) {\n        this.linking = true\n\n        this.$emit('linkingBreak', index)\n        if (e.preventDefault) e.preventDefault()\n      },\n      save () {\n        this.$emit('update')\n      },\n      deleteBlock () {\n        this.$emit('delete')\n      },\n      moveWithDiff (diffX, diffY) {\n        let left = this.x + diffX / this.options.scale\n        let top = this.y + diffY / this.options.scale\n\n        this.$emit('update:x', left)\n        this.$emit('update:y', top)\n      }\n    },\n    computed: {\n      style () {\n        return {\n          top: this.options.center.y + this.y * this.options.scale + 'px',\n          left: this.options.center.x + this.x * this.options.scale + 'px',\n          width: this.width + 'px',\n          transform: 'scale(' + (this.options.scale + '') + ')',\n          transformOrigin: 'top left'\n        }\n      },\n      headerStyle () {\n        return {\n          height: this.options.titleHeight + 'px'\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n  @blockBorder: 1px;\n\n  @ioPaddingInner: 2px 0;\n  @ioHeight: 16px;\n  @ioFontSize: 14px;\n\n  @circleBorder: 1px;\n  @circleSize: 10px;\n  @circleMargin: 2px; // left/right\n\n  @circleNewColor: #00FF00;\n  @circleRemoveColor: #FF0000;\n  @circleConnectedColor: #FFFF00;\n\n  .vue-block {\n    position: absolute;\n    box-sizing: border-box;\n    border: @blockBorder solid black;\n    background: white;\n    z-index: 1;\n    opacity: 0.9;\n    cursor: move;\n\n    &.selected {\n      border: @blockBorder solid red;\n      z-index: 2;\n    }\n\n    > header {\n      background: #bfbfbf;\n      text-align: center;\n\n      > .delete {\n        color: red;\n        cursor: pointer;\n        float: right;\n        position: absolute;\n        right: 5px;\n      }\n    }\n\n    .inputs, .outputs {\n      padding: @ioPaddingInner;\n\n      display: block;\n      width: 50%;\n\n      > * {\n        width: 100%;\n      }\n    }\n\n    .circle {\n      box-sizing: border-box;\n      margin-top: @ioHeight / 2 - @circleSize / 2;\n\n      width: @circleSize;\n      height: @circleSize;\n\n      border: @circleBorder solid rgba(0, 0, 0, 0.5);\n      border-radius: 100%;\n\n      cursor: crosshair;\n      &.active {\n        background: @circleConnectedColor;\n      }\n    }\n\n    .inputs {\n      float: left;\n      text-align: left;\n\n      margin-left: -(@circleSize/2 + @blockBorder);\n    }\n\n    .input, .output {\n      height: @ioHeight;\n      overflow: hidden;\n      font-size: @ioFontSize;\n\n      &:last-child {\n      }\n    }\n\n    .input {\n      float: left;\n\n      .circle {\n        float: left;\n        margin-right: @circleMargin;\n\n        &:hover {\n          background: @circleNewColor;\n\n          &.active {\n            background: @circleRemoveColor;\n          }\n        }\n      }\n    }\n\n    .outputs {\n      float: right;\n      text-align: right;\n\n      margin-right: -(@circleSize/2 + @blockBorder);\n    }\n\n    .output {\n      float: right;\n\n      .circle {\n        float: right;\n        margin-left: @circleMargin;\n\n        &:hover {\n          background: @circleNewColor;\n        }\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/VueBlock.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vue-block\",class:{selected: _vm.selected},style:(_vm.style)},[_c('header',{style:(_vm.headerStyle)},[_vm._v(\"\\n    \"+_vm._s(_vm.title)+\"\\n    \"),_c('a',{staticClass:\"delete\",on:{\"click\":_vm.deleteBlock}},[_vm._v(\"x\")])]),_vm._v(\" \"),_c('div',{staticClass:\"inputs\"},_vm._l((_vm.inputs),function(slot,index){return _c('div',{staticClass:\"input\"},[_c('div',{staticClass:\"circle inputSlot\",class:{active: slot.active},on:{\"mouseup\":function($event){_vm.slotMouseUp($event, index)},\"mousedown\":function($event){_vm.slotBreak($event, index)}}}),_vm._v(\"\\n      \"+_vm._s(slot.label)+\"\\n    \")])})),_vm._v(\" \"),_c('div',{staticClass:\"outputs\"},_vm._l((_vm.outputs),function(slot,index){return _c('div',{staticClass:\"output\"},[_c('div',{staticClass:\"circle\",class:{active: slot.active},on:{\"mousedown\":function($event){_vm.slotMouseDown($event, index)}}}),_vm._v(\"\\n      \"+_vm._s(slot.label)+\"\\n    \")])}))])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9a4bcc94\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/VueBlock.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9a4bcc94\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./VueBlock.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlock.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlock.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9a4bcc94\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./VueBlock.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-9a4bcc94\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/VueBlock.vue\n// module id = null\n// module chunks = ","<template>\n  <svg width=\"100%\" height=\"100%\">\n    <g v-for=\"p in renderedPathes\" >\n      <path v-if=\"outline\" :d=\"p.data\" :style=\"p.outlineStyle\"></path>\n      <path :d=\"p.data\" :style=\"p.style\"></path>\n    </g>\n    <g>\n      <path v-for=\"a in renderedArrows\"\n        d=\"M -1 -1 L 0 1 L 1 -1 z\"\n        :style=\"a.style\"\n        :transform=\"a.transform\"></path>\n    </g>\n  </svg>\n</template>\n\n<script>\n  export default {\n    props: {\n      lines: {\n        type: Array,\n        default () {\n          return []\n        }\n      },\n      outline: {\n        type: Boolean,\n        default: false\n      }\n    },\n    methods: {\n      distance (x1, y1, x2, y2) {\n        return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1))\n      },\n      computeConnectionPoint (x1, y1, x2, y2, t) {\n        let dist = this.distance(x1, y1, x2, y2)\n        let p0 = {x: x1, y: y1}\n        let p1 = {x: x1 + dist * 0.25, y: y1}\n        let p2 = {x: x2 - dist * 0.25, y: y2}\n        let p3 = {x: x2, y: y2}\n\n        let c1 = (1 - t) * (1 - t) * (1 - t)\n        let c2 = 3 * ((1 - t) * (1 - t)) * t\n        let c3 = 3 * (1 - t) * (t * t)\n        let c4 = t * t * t\n\n        let x = c1 * p0.x + c2 * p1.x + c3 * p2.x + c4 * p3.x\n        let y = c1 * p0.y + c2 * p1.y + c3 * p2.y + c4 * p3.y\n        return {x: x, y: y}\n      }\n    },\n    computed: {\n      renderedPathes () {\n        if (!this.lines) {\n          return []\n        }\n\n        let pathes = []\n        this.lines.forEach(l => {\n          let dist = this.distance(l.x1, l.y1, l.x2, l.y2) * 0.25\n          pathes.push({\n            data: `M ${l.x1}, ${l.y1} C ${(l.x1 + dist)}, ${l.y1}, ${(l.x2 - dist)}, ${l.y2}, ${l.x2}, ${l.y2}`,\n            style: l.style,\n            outlineStyle: l.outlineStyle\n          })\n        })\n\n        return pathes\n      },\n      renderedArrows () {\n        if (!this.lines) {\n          return []\n        }\n\n        let arrows = []\n        this.lines.forEach(l => {\n          // l.x1, l.y1, l.x2, l.y2\n          let pos = this.computeConnectionPoint(l.x1, l.y1, l.x2, l.y2, 0.5)\n          let pos2 = this.computeConnectionPoint(l.x1, l.y1, l.x2, l.y2, 0.51)\n\n          let angle = -Math.atan2(pos2.x - pos.x, pos2.y - pos.y)\n          let degrees = (angle >= 0 ? angle : (2 * Math.PI + angle)) * 180 / Math.PI\n\n          arrows.push({\n            transform: `translate(${pos.x}, ${pos.y}) rotate(${degrees})`,\n            style: {\n              stroke: l.style.stroke,\n              strokeWidth: l.style.strokeWidth * 2,\n              fill: l.style.stroke\n            }\n          })\n        })\n\n        return arrows\n      }\n    }\n  }\n</script>\n\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/VueLink.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{attrs:{\"width\":\"100%\",\"height\":\"100%\"}},[_vm._l((_vm.renderedPathes),function(p){return _c('g',[(_vm.outline)?_c('path',{style:(p.outlineStyle),attrs:{\"d\":p.data}}):_vm._e(),_vm._v(\" \"),_c('path',{style:(p.style),attrs:{\"d\":p.data}})])}),_vm._v(\" \"),_c('g',_vm._l((_vm.renderedArrows),function(a){return _c('path',{style:(a.style),attrs:{\"d\":\"M -1 -1 L 0 1 L 1 -1 z\",\"transform\":a.transform}})}))],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-56aa24a8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/VueLink.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-56aa24a8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./VueLink.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueLink.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueLink.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-56aa24a8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./VueLink.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-56aa24a8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/VueLink.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"vue-container\">\n    <VueLink :lines=\"lines\"/>\n    <VueBlock v-for=\"block in blocks\"\n              :key=\"block.id\"\n              v-bind.sync=\"block\"\n              :options=\"optionsForChild\"\n              @update=\"updateScene\"\n              @linkingStart=\"linkingStart(block, $event)\"\n              @linkingStop=\"linkingStop(block, $event)\"\n              @linkingBreak=\"linkingBreak(block, $event)\"\n              @select=\"blockSelect(block)\"\n              @delete=\"blockDelete(block)\"\n    />\n  </div>\n</template>\n\n<script>\n  import merge from 'deepmerge'\n  import mouseHelper from '../helpers/mouse'\n\n  import VueBlock from './VueBlock'\n  import VueLink from './VueLink'\n\n  export default {\n    name: 'VueBlockContainer',\n    components: {\n      VueBlock,\n      VueLink\n    },\n    props: {\n      blocksContent: {\n        type: Array,\n        default () {\n          return []\n        }\n      },\n      scene: {\n        type: Object,\n        default: {blocks: [], links: [], container: {}}\n      },\n      options: {\n        type: Object\n      }\n    },\n    mounted () {\n      document.documentElement.addEventListener('mousemove', this.handleMove, true)\n      document.documentElement.addEventListener('mousedown', this.handleDown, true)\n      document.documentElement.addEventListener('mouseup', this.handleUp, true)\n      document.documentElement.addEventListener('wheel', this.handleWheel, true)\n\n      this.centerX = this.$el.clientWidth / 2\n      this.centerY = this.$el.clientHeight / 2\n\n      this.importBlocksContent()\n      this.importScene()\n    },\n    beforeDestroy () {\n      document.documentElement.removeEventListener('mousemove', this.handleMove, true)\n      document.documentElement.removeEventListener('mousedown', this.handleDown, true)\n      document.documentElement.removeEventListener('mouseup', this.handleUp, true)\n      document.documentElement.removeEventListener('wheel', this.handleWheel, true)\n    },\n    created () {\n      this.mouseX = 0\n      this.mouseY = 0\n\n      this.lastMouseX = 0\n      this.lastMouseY = 0\n\n      this.minScale = 0.2\n      this.maxScale = 5\n\n      this.linking = false\n      this.linkStartData = null\n\n      this.inputSlotClassName = 'inputSlot'\n\n      this.defaultScene = {\n        blocks: [],\n        links: [],\n        container: {}\n      }\n    },\n    data () {\n      return {\n        dragging: false,\n        //\n        centerX: 0,\n        centerY: 0,\n        scale: 1,\n        //\n        nodes: [],\n        blocks: [],\n        links: [],\n        //\n        tempLink: null,\n        selectedBlock: null,\n        hasDragged: false\n      }\n    },\n    computed: {\n      optionsForChild () {\n        return {\n          width: 200,\n          titleHeight: 20,\n          scale: this.scale,\n          inputSlotClassName: this.inputSlotClassName,\n          center: {\n            x: this.centerX,\n            y: this.centerY\n          }\n        }\n      },\n      container () {\n        return {\n          centerX: this.centerX,\n          centerY: this.centerY,\n          scale: this.scale\n        }\n      },\n      // Links calculate\n      lines () {\n        let lines = []\n\n        for (let link of this.links) {\n          let originBlock = this.blocks.find(block => {\n            return block.id === link.originID\n          })\n\n          let targetBlock = this.blocks.find(block => {\n            return block.id === link.targetID\n          })\n\n          if (!originBlock || !targetBlock) {\n            console.log('Remove invalid link', link)\n            this.removeLink(link.id)\n            continue\n          }\n\n          if (originBlock.id === targetBlock.id) {\n            console.log('Loop detected, remove link', link)\n            this.removeLink(link.id)\n            continue\n          }\n\n          let originLinkPos = this.getConnectionPos(originBlock, link.originSlot, false)\n          let targetLinkPos = this.getConnectionPos(targetBlock, link.targetSlot, true)\n\n          if (!originLinkPos || !targetLinkPos) {\n            console.log('Remove invalid link (slot not exist)', link)\n            this.removeLink(link.id)\n            continue\n          }\n\n          let x1 = originLinkPos.x\n          let y1 = originLinkPos.y\n\n          let x2 = targetLinkPos.x\n          let y2 = targetLinkPos.y\n\n          lines.push({\n            x1: x1,\n            y1: y1,\n            x2: x2,\n            y2: y2,\n            style: {\n              stroke: '#F85',\n              strokeWidth: 4 * this.scale,\n              fill: 'none'\n            },\n            outlineStyle: {\n              stroke: '#666',\n              strokeWidth: 6 * this.scale,\n              strokeOpacity: 0.6,\n              fill: 'none'\n            }\n          })\n        }\n\n        if (this.tempLink) {\n          this.tempLink.style = {\n            stroke: '#8f8f8f',\n            strokeWidth: 4 * this.scale,\n            fill: 'none'\n          }\n\n          lines.push(this.tempLink)\n        }\n\n        return lines\n      }\n    },\n    methods: {\n      // Events\n      /** @param e {MouseEvent} */\n      handleMove (e) {\n        let mouse = mouseHelper.getMousePosition(this.$el, e)\n        this.mouseX = mouse.x\n        this.mouseY = mouse.y\n\n        if (this.dragging) {\n          let diffX = this.mouseX - this.lastMouseX\n          let diffY = this.mouseY - this.lastMouseY\n\n          this.lastMouseX = this.mouseX\n          this.lastMouseY = this.mouseY\n\n          this.centerX += diffX\n          this.centerY += diffY\n\n          this.hasDragged = true\n        }\n\n        if (this.linking && this.linkStartData) {\n          let linkStartPos = this.getConnectionPos(this.linkStartData.block, this.linkStartData.slotNumber, false)\n          this.tempLink = {\n            x1: linkStartPos.x,\n            y1: linkStartPos.y,\n            x2: this.mouseX,\n            y2: this.mouseY\n          }\n        }\n      },\n      handleDown (e) {\n        const target = e.target || e.srcElement\n        if ((target === this.$el || target.matches('svg, svg *')) && e.which === 1) {\n          this.dragging = true\n\n          let mouse = mouseHelper.getMousePosition(this.$el, e)\n          this.mouseX = mouse.x\n          this.mouseY = mouse.y\n\n          this.lastMouseX = this.mouseX\n          this.lastMouseY = this.mouseY\n\n          this.deselectAll()\n          if (e.preventDefault) e.preventDefault()\n        }\n      },\n      handleUp (e) {\n        const target = e.target || e.srcElement\n\n        if (this.dragging) {\n          this.dragging = false\n\n          if (this.hasDragged) {\n            this.updateScene()\n            this.hasDragged = false\n          }\n        }\n\n        if (this.$el.contains(target) && (typeof target.className !== 'string' || target.className.indexOf(this.inputSlotClassName) === -1)) {\n          this.linking = false\n          this.tempLink = null\n          this.linkStartData = null\n        }\n      },\n      handleWheel (e) {\n        const target = e.target || e.srcElement\n        if (this.$el.contains(target)) {\n          if (e.preventDefault) e.preventDefault()\n\n          let deltaScale = Math.pow(1.1, e.deltaY * -0.01)\n          this.scale *= deltaScale\n\n          if (this.scale < this.minScale) {\n            this.scale = this.minScale\n            return\n          } else if (this.scale > this.maxScale) {\n            this.scale = this.maxScale\n            return\n          }\n\n          let zoomingCenter = {\n            x: this.mouseX,\n            y: this.mouseY\n          }\n\n          let deltaOffsetX = (zoomingCenter.x - this.centerX) * (deltaScale - 1)\n          let deltaOffsetY = (zoomingCenter.y - this.centerY) * (deltaScale - 1)\n\n          this.centerX -= deltaOffsetX\n          this.centerY -= deltaOffsetY\n\n          this.updateScene()\n        }\n      },\n      // Processing\n      getConnectionPos (block, slotNumber, isInput) {\n        if (!block || slotNumber === -1) {\n          return undefined\n        }\n\n        let x = 0\n        let y = 0\n\n        x += block.x\n        y += block.y\n\n        y += this.optionsForChild.titleHeight\n\n        if (isInput && block.inputs.length > slotNumber) {\n        } else if (!isInput && block.outputs.length > slotNumber) {\n          x += this.optionsForChild.width\n        } else {\n          console.error('slot ' + slotNumber + ' not found, is input: ' + isInput, block)\n          return undefined\n        }\n\n        // (height / 2 + blockBorder + padding)\n        y += (16 / 2 + 1 + 2)\n        //  + (height * slotNumber)\n        y += (16 * slotNumber)\n\n        x *= this.scale\n        y *= this.scale\n\n        x += this.centerX\n        y += this.centerY\n\n        return {x: x, y: y}\n      },\n      // Linking\n      linkingStart (block, slotNumber) {\n        this.linkStartData = {block: block, slotNumber: slotNumber}\n        let linkStartPos = this.getConnectionPos(this.linkStartData.block, this.linkStartData.slotNumber, false)\n        this.tempLink = {\n          x1: linkStartPos.x,\n          y1: linkStartPos.y,\n          x2: this.mouseX,\n          y2: this.mouseY\n        }\n\n        this.linking = true\n      },\n      linkingStop (targetBlock, slotNumber) {\n        if (this.linkStartData && targetBlock && slotNumber > -1) {\n          this.links = this.links.filter(value => {\n            return !(value.targetID === targetBlock.id && value.targetSlot === slotNumber)\n          })\n\n          let maxID = Math.max(0, ...this.links.map(function (o) {\n            return o.id\n          }))\n\n          // skip if looping\n          if (this.linkStartData.block.id !== targetBlock.id) {\n            this.links.push({\n              id: maxID + 1,\n              originID: this.linkStartData.block.id,\n              originSlot: this.linkStartData.slotNumber,\n              targetID: targetBlock.id,\n              targetSlot: slotNumber\n            })\n            this.updateScene()\n          }\n        }\n\n        this.linking = false\n        this.tempLink = null\n        this.linkStartData = null\n      },\n      linkingBreak (targetBlock, slotNumber) {\n        if (targetBlock && slotNumber > -1) {\n          let findLink = this.links.find(value => {\n            return value.targetID === targetBlock.id && value.targetSlot === slotNumber\n          })\n\n          if (findLink) {\n            let findBlock = this.blocks.find(value => {\n              return value.id === findLink.originID\n            })\n\n            this.links = this.links.filter(value => {\n              return !(value.targetID === targetBlock.id && value.targetSlot === slotNumber)\n            })\n\n            this.linkingStart(findBlock, findLink.originSlot)\n\n            this.updateScene()\n          }\n        }\n      },\n      removeLink (linkID) {\n        this.links = this.links.filter(value => {\n          return !(value.id === linkID)\n        })\n      },\n      // Blocks\n      addNewBlock (nodeName, x, y) {\n        let maxID = Math.max(0, ...this.blocks.map(function (o) {\n          return o.id\n        }))\n\n        let node = this.nodes.find(n => {\n          return n.name === nodeName\n        })\n\n        if (!node) {\n          return\n        }\n        let block = this.createBlock(node, maxID + 1)\n\n        // if x or y not set, place block to center\n        if (x === undefined || y === undefined) {\n          x = (this.$el.clientWidth / 2 - this.centerX) / this.scale\n          y = (this.$el.clientHeight / 2 - this.centerY) / this.scale\n        } else {\n          x = (x - this.centerX) / this.scale\n          y = (y - this.centerY) / this.scale\n        }\n\n        block.x = x\n        block.y = y\n        this.blocks.push(block)\n\n        this.updateScene()\n      },\n      createBlock (node, id) {\n        let inputs = []\n        let outputs = []\n        let values = {}\n\n        node.fields.forEach(field => {\n          if (field.attr === 'input') {\n            inputs.push({\n              name: field.name,\n              label: field.label || field.name\n            })\n          } else if (field.attr === 'output') {\n            outputs.push({\n              name: field.name,\n              label: field.label || field.name\n            })\n          } else {\n            if (!values[field.attr]) {\n              values[field.attr] = {}\n            }\n\n            let newField = merge({}, field)\n            delete newField['name']\n            delete newField['attr']\n\n            if (!values[field.attr][field.name]) {\n              values[field.attr][field.name] = {}\n            }\n\n            values[field.attr][field.name] = newField\n          }\n        })\n\n        return {\n          id: id,\n          x: 0,\n          y: 0,\n          selected: false,\n          name: node.name,\n          title: node.title || node.name,\n          inputs: inputs,\n          outputs: outputs,\n          values: values\n        }\n      },\n      deselectAll (withoutID = null) {\n        this.blocks.forEach((value) => {\n          if (value.id !== withoutID && value.selected) {\n            this.blockDeselect(value)\n          }\n        })\n      },\n      // Events\n      blockSelect (block) {\n        block.selected = true\n        this.selectedBlock = block\n        this.deselectAll(block.id)\n        this.$emit('blockSelect', block)\n      },\n      blockDeselect (block) {\n        block.selected = false\n\n        if (block &&\n          this.selectedBlock &&\n          this.selectedBlock.id === block.id\n        ) {\n          this.selectedBlock = null\n        }\n\n        this.$emit('blockDeselect', block)\n      },\n      blockDelete (block) {\n        if (block.selected) {\n          this.blockDeselect(block)\n        }\n        this.links.forEach(l => {\n          if (l.originID === block.id || l.targetID === block.id) {\n            this.removeLink(l.id)\n          }\n        })\n        this.blocks = this.blocks.filter(b => {\n          return b.id !== block.id\n        })\n        this.updateScene()\n      },\n      //\n      prepareBlocks (blocks) {\n        return blocks.map(block => {\n          let node = this.nodes.find(n => {\n            return n.name === block.name\n          })\n\n          if (!node) {\n            return null\n          }\n\n          let newBlock = this.createBlock(node, block.id)\n\n          newBlock = merge(newBlock, block, {\n            arrayMerge: (d, s) => {\n              return s.length === 0 ? d : s\n            }\n          })\n\n          return newBlock\n        }).filter(b => {\n          return !!b\n        })\n      },\n      prepareBlocksLinking (blocks, links) {\n        if (!blocks) {\n          return []\n        }\n\n        let newBlocks = []\n\n        blocks.forEach(block => {\n          let inputs = links.filter(link => {\n            return link.targetID === block.id\n          })\n\n          let outputs = links.filter(link => {\n            return link.originID === block.id\n          })\n\n          block.inputs.forEach((s, index) => {\n            // is linked\n            block.inputs[index].active = inputs.some(i => i.targetSlot === index)\n          })\n\n          block.outputs.forEach((s, index) => {\n            // is linked\n            block.outputs[index].active = outputs.some(i => i.originSlot === index)\n          })\n\n          newBlocks.push(block)\n        })\n\n        return newBlocks\n      },\n      importBlocksContent () {\n        if (this.blocksContent) {\n          this.nodes = merge([], this.blocksContent)\n        }\n      },\n      importScene () {\n        let scene = merge(this.defaultScene, this.scene)\n\n        let blocks = this.prepareBlocks(scene.blocks)\n        blocks = this.prepareBlocksLinking(blocks, scene.links)\n\n        // set last selected after update blocks from props\n        if (this.selectedBlock) {\n          let block = blocks.find(b => this.selectedBlock.id === b.id)\n          if (block) {\n            block.selected = true\n          }\n        }\n\n        this.blocks = blocks\n        this.links = merge([], scene.links)\n\n        let container = scene.container\n        if (container.centerX) {\n          this.centerX = container.centerX\n        }\n        if (container.centerY) {\n          this.centerY = container.centerY\n        }\n        if (container.scale) {\n          this.scale = container.scale\n        }\n      },\n      exportScene () {\n        let clonedBlocks = merge([], this.blocks)\n        let blocks = clonedBlocks.map(value => {\n          delete value['inputs']\n          delete value['outputs']\n          delete value['selected']\n\n          return value\n        })\n\n        return {\n          blocks: blocks,\n          links: this.links,\n          container: this.container\n        }\n      },\n      updateScene () {\n        this.$emit('update:scene', this.exportScene())\n      }\n    },\n    watch: {\n      blocksContent () {\n        this.importBlocksContent()\n      },\n      scene () {\n        this.importScene()\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n  .vue-container {\n    position: relative;\n    overflow: hidden;\n    box-sizing: border-box;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/VueBlocksContainer.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vue-container\"},[_c('VueLink',{attrs:{\"lines\":_vm.lines}}),_vm._v(\" \"),_vm._l((_vm.blocks),function(block){return _c('VueBlock',_vm._b({key:block.id,attrs:{\"options\":_vm.optionsForChild},on:{\"update\":_vm.updateScene,\"linkingStart\":function($event){_vm.linkingStart(block, $event)},\"linkingStop\":function($event){_vm.linkingStop(block, $event)},\"linkingBreak\":function($event){_vm.linkingBreak(block, $event)},\"select\":function($event){_vm.blockSelect(block)},\"delete\":function($event){_vm.blockDelete(block)}}},'VueBlock',block,false,true))})],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-cd11bc44\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/VueBlocksContainer.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-cd11bc44\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./VueBlocksContainer.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlocksContainer.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlocksContainer.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-cd11bc44\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./VueBlocksContainer.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-cd11bc44\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/VueBlocksContainer.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"blocks-properties\"},[_vm._l((_vm.properties),function(p){return _c('div',{staticClass:\"property\"},[_c('label',{attrs:{\"for\":p.name}},[_vm._v(_vm._s(p.label||p.name)+\":\")]),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(p.value),expression:\"p.value\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(p.value)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(p, \"value\", $event.target.value)}}})])}),_vm._v(\" \"),_c('button',{on:{\"click\":function($event){$event.preventDefault();_vm.save($event)}}},[_vm._v(\"Save\")])],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-d11cfc5a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/VueBlockProperty.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d11cfc5a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./VueBlockProperty.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlockProperty.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./VueBlockProperty.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d11cfc5a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./VueBlockProperty.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-d11cfc5a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/VueBlockProperty.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <VueBlocksContainer\n      @contextmenu.native=\"showContextMenu\"\n      @click.native=\"closeContextMenu\"\n      ref=\"container\"\n      :blocksContent=\"blocks\"\n      :scene.sync=\"scene\"\n      @blockSelect=\"selectBlock\"\n      @blockDeselect=\"deselectBlock\"\n      class=\"container\"/>\n    <VueBlockProperty :property=\"selectedBlockProperty\" @save=\"saveProperty\"/>\n    <label>\n      <select name=\"type\" v-model=\"selectedType\">\n        <template v-for=\"type in selectBlocksType\">\n          <optgroup :label=\"type\">\n            <option v-for=\"block in filteredBlocks(type)\" :value=\"block.name\">{{block.title || block.name}}</option>\n          </optgroup>\n        </template>\n      </select>\n    </label>\n    <button @click.stop=\"addBlock\">Add</button>\n    |\n    <label for=\"useContextMenu\">\n      <input type=\"checkbox\" v-model=\"useContextMenu\" id=\"useContextMenu\">Use right click for Add blocks\n    </label>\n\n    <ul id=\"contextMenu\" ref=\"contextMenu\" tabindex=\"-1\" v-show=\"contextMenu.isShow\"\n        @blur=\"closeContextMenu\"\n        :style=\"{top: contextMenu.top + 'px', left: contextMenu.left + 'px'}\">\n      <template v-for=\"type in selectBlocksType\">\n        <li class=\"label\">{{type}}</li>\n        <li v-for=\"block in filteredBlocks(type)\"\n            @click=\"addBlockContextMenu(block.name)\">{{block.title || block.name}}\n        </li>\n      </template>\n    </ul>\n  </div>\n</template>\n\n<script>\n  import merge from 'deepmerge'\n\n  import VueBlocksContainer from './components/VueBlocksContainer'\n  import VueBlockProperty from './components/VueBlockProperty'\n  import domHelper from './helpers/dom'\n\n  export default {\n    name: 'App',\n    components: {\n      VueBlocksContainer,\n      VueBlockProperty\n    },\n    data: function () {\n      return {\n        blocks: [\n          {\n            name: 'text',\n            title: 'Text',\n            family: 'Animations',\n            description: 'Show text',\n            fields: [\n              {\n                name: 'text',\n                label: 'Text',\n                type: 'string',\n                attr: 'property'\n              },\n              {\n                name: 'delay',\n                label: 'Delay (s)',\n                type: 'number',\n                attr: 'property'\n              },\n              {\n                name: 'Show',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'Hide',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'onShow',\n                type: 'event',\n                attr: 'output'\n              },\n              {\n                name: 'onHide',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          },\n          {\n            name: 'animation',\n            title: 'Animation',\n            family: 'Animations',\n            description: 'Show animation',\n            fields: [\n              {\n                name: 'animation',\n                label: 'Animation',\n                type: 'animation',\n                attr: 'property'\n              },\n              {\n                name: 'Play',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'Stop',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'onEnd',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          },\n          {\n            name: 'Chat message',\n            family: 'Events',\n            description: '',\n            fields: [\n              {\n                name: 'message',\n                label: 'Activation message',\n                type: 'string',\n                attr: 'property'\n              },\n              {\n                name: 'onMessage',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          },\n          {\n            name: 'delay',\n            title: 'Delay',\n            family: 'Time',\n            description: '',\n            fields: [\n              {\n                name: 'delay',\n                label: 'Delay (s)',\n                type: 'number',\n                attr: 'property',\n                value: 1.0\n              },\n              {\n                name: 'input',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'output',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          },\n          {\n            name: 'shortcuts',\n            title: 'Shortcuts',\n            family: 'Events',\n            description: 'Press shortcut for call event',\n            fields: [\n              {\n                name: 'keys',\n                label: 'Activation keys',\n                type: 'keys',\n                attr: 'property'\n              },\n              {\n                name: 'onPress',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          },\n          {\n            name: 'splitter',\n            title: 'Splitter',\n            family: 'Helpers',\n            description: 'Press shortcut for call event',\n            fields: [\n              {\n                name: 'input',\n                type: 'event',\n                attr: 'input'\n              },\n              {\n                name: 'output',\n                type: 'event',\n                attr: 'output'\n              },\n              {\n                name: 'output',\n                type: 'event',\n                attr: 'output'\n              },\n              {\n                name: 'output',\n                type: 'event',\n                attr: 'output'\n              },\n              {\n                name: 'output',\n                type: 'event',\n                attr: 'output'\n              }\n            ]\n          }\n        ],\n        scene: {\n          blocks: [\n            {\n              id: 2,\n              x: -700,\n              y: -69,\n              name: 'Chat message',\n              title: 'Chat message',\n              values: {\n                property: [\n                  {\n                    name: 'message',\n                    type: 'string'\n                  }\n                ]\n              }\n            },\n            {\n              id: 4,\n              x: -157,\n              y: -68.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 5,\n              x: 136,\n              y: -48.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 6,\n              x: -440,\n              y: -15.5,\n              name: 'delay',\n              title: 'Delay',\n              values: {\n                property: {\n                  delay: {\n                    label: 'Delay (s)',\n                    type: 'number',\n                    value: 1\n                  }\n                }\n              }\n            },\n            {\n              id: 7,\n              x: -694,\n              y: 60.5,\n              name: 'shortcuts',\n              title: 'Shortcuts',\n              values: {\n                property: {\n                  keys: {\n                    label: 'Activation keys',\n                    type: 'keys'\n                  }\n                }\n              }\n            },\n            {\n              id: 8,\n              x: -163,\n              y: 59.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 9,\n              x: -429,\n              y: 125.5,\n              name: 'delay',\n              title: 'Delay',\n              values: {\n                property: {\n                  delay: {\n                    label: 'Delay (s)',\n                    type: 'number',\n                    value: 1\n                  }\n                }\n              }\n            },\n            {\n              id: 10,\n              x: 126,\n              y: 127.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 11,\n              x: -856,\n              y: 252.5,\n              name: 'shortcuts',\n              title: 'Shortcuts',\n              values: {\n                property: {\n                  keys: {\n                    label: 'Activation keys',\n                    type: 'keys'\n                  }\n                }\n              }\n            },\n            {\n              id: 12,\n              x: -616,\n              y: 319.5,\n              name: 'delay',\n              title: 'Delay',\n              values: {\n                property: {\n                  delay: {\n                    label: 'Delay (s)',\n                    type: 'number',\n                    value: 1\n                  }\n                }\n              }\n            },\n            {\n              id: 13,\n              x: -381,\n              y: 252.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 14,\n              x: 166,\n              y: 266.5,\n              name: 'text',\n              title: 'Text',\n              values: {\n                property: {\n                  text: {\n                    label: 'Text',\n                    type: 'string'\n                  }\n                }\n              }\n            },\n            {\n              id: 15,\n              x: -149,\n              y: 269.5,\n              name: 'delay',\n              title: 'Delay',\n              values: {\n                property: {\n                  delay: {\n                    label: 'Delay (s)',\n                    type: 'number',\n                    value: 1\n                  }\n                }\n              }\n            },\n            {\n              id: 16,\n              x: 413,\n              y: 267.5,\n              name: 'animation',\n              title: 'Animation',\n              values: {\n                property: {\n                  animation: {\n                    label: 'Animation',\n                    type: 'animation'\n                  }\n                }\n              }\n            },\n            {\n              id: 17,\n              x: 13,\n              y: 380.5,\n              name: 'delay',\n              title: 'Delay',\n              values: {\n                property: {\n                  delay: {\n                    label: 'Delay (s)',\n                    type: 'number',\n                    value: 1\n                  }\n                }\n              }\n            }\n          ],\n          links: [\n            {\n              id: 3,\n              originID: 2,\n              originSlot: 0,\n              targetID: 4,\n              targetSlot: 0\n            },\n            {\n              id: 6,\n              originID: 7,\n              originSlot: 0,\n              targetID: 8,\n              targetSlot: 0\n            },\n            {\n              id: 7,\n              originID: 7,\n              originSlot: 0,\n              targetID: 9,\n              targetSlot: 0\n            },\n            {\n              id: 8,\n              originID: 9,\n              originSlot: 0,\n              targetID: 10,\n              targetSlot: 0\n            },\n            {\n              id: 9,\n              originID: 9,\n              originSlot: 0,\n              targetID: 8,\n              targetSlot: 1\n            },\n            {\n              id: 10,\n              originID: 2,\n              originSlot: 0,\n              targetID: 6,\n              targetSlot: 0\n            },\n            {\n              id: 11,\n              originID: 6,\n              originSlot: 0,\n              targetID: 4,\n              targetSlot: 1\n            },\n            {\n              id: 12,\n              originID: 4,\n              originSlot: 1,\n              targetID: 5,\n              targetSlot: 0\n            },\n            {\n              id: 13,\n              originID: 11,\n              originSlot: 0,\n              targetID: 13,\n              targetSlot: 0\n            },\n            {\n              id: 14,\n              originID: 11,\n              originSlot: 0,\n              targetID: 12,\n              targetSlot: 0\n            },\n            {\n              id: 15,\n              originID: 12,\n              originSlot: 0,\n              targetID: 13,\n              targetSlot: 1\n            },\n            {\n              id: 16,\n              originID: 13,\n              originSlot: 1,\n              targetID: 15,\n              targetSlot: 0\n            },\n            {\n              id: 17,\n              originID: 15,\n              originSlot: 0,\n              targetID: 14,\n              targetSlot: 0\n            },\n            {\n              id: 18,\n              originID: 14,\n              originSlot: 0,\n              targetID: 16,\n              targetSlot: 0\n            },\n            {\n              id: 19,\n              originID: 14,\n              originSlot: 1,\n              targetID: 16,\n              targetSlot: 1\n            },\n            {\n              id: 20,\n              originID: 15,\n              originSlot: 0,\n              targetID: 17,\n              targetSlot: 0\n            },\n            {\n              id: 21,\n              originID: 17,\n              originSlot: 0,\n              targetID: 14,\n              targetSlot: 1\n            }\n          ],\n          container: {\n            centerX: 1042,\n            centerY: 140,\n            scale: 1\n          }\n        },\n        selectedBlock: null,\n        selectedType: 'delay',\n        useContextMenu: true,\n        contextMenu: {\n          isShow: false,\n          mouseX: 0,\n          mouseY: 0,\n          top: 0,\n          left: 0\n        }\n      }\n    },\n    computed: {\n      selectedBlockProperty () {\n        if (!this.selectedBlock || !this.selectedBlock.values || !this.selectedBlock.values.property) {\n          return null\n        }\n\n        return this.selectedBlock.values.property\n      },\n      selectBlocksType () {\n        return this.blocks.map(b => {\n          return b.family\n        }).filter((value, index, array) => {\n          return array.indexOf(value) === index\n        })\n      }\n    },\n    methods: {\n      selectBlock (block) {\n        console.log('select', block)\n        this.selectedBlock = block\n      },\n      deselectBlock (block) {\n        console.log('deselect', block)\n        this.selectedBlock = null\n      },\n      filteredBlocks (type) {\n        return this.blocks.filter(value => {\n          return value.family === type\n        })\n      },\n      addBlock () {\n        console.log(this.selectedType)\n        this.$refs.container.addNewBlock(this.selectedType)\n      },\n      saveProperty (val) {\n        console.log(val)\n\n        let scene = this.scene\n        let block = scene.blocks.find(b => {\n          return b.id === this.selectedBlock.id\n        })\n        block.values.property = val\n\n        this.scene = merge({}, scene)\n      },\n      showContextMenu (e) {\n        if (!this.useContextMenu) return\n        if (e.preventDefault) e.preventDefault()\n\n        this.contextMenu.isShow = true\n        this.contextMenu.mouseX = e.x\n        this.contextMenu.mouseY = e.y\n\n        this.$nextTick(function () {\n          this.setMenu(e.y, e.x)\n          this.$refs.contextMenu.focus()\n        })\n      },\n      setMenu (top, left) {\n        let border = 5\n        let contextMenuEl = this.$refs.contextMenu\n        let containerElRect = this.$refs.container.$el.getBoundingClientRect()\n        let largestWidth = containerElRect.right - contextMenuEl.offsetWidth - border\n        let largestHeight = containerElRect.bottom - contextMenuEl.offsetHeight - border\n\n        console.log(this.$refs.container)\n        console.log(containerElRect)\n\n        if (left > largestWidth) left = largestWidth\n        if (top > largestHeight) top = largestHeight\n\n        this.contextMenu.top = top\n        this.contextMenu.left = left\n      },\n      addBlockContextMenu (name) {\n        let offset = domHelper.getOffsetRect(this.$refs.container.$el)\n        let x = this.contextMenu.mouseX - offset.left\n        let y = this.contextMenu.mouseY - offset.top\n\n        this.$refs.container.addNewBlock(name, x, y)\n        this.closeContextMenu()\n      },\n      closeContextMenu () {\n        this.contextMenu.isShow = false\n      }\n    },\n    watch: {\n      blocks (newValue) {\n        console.log('blocks', JSON.stringify(newValue))\n      },\n      scene (newValue) {\n        console.log('scene', JSON.stringify(newValue))\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\">\n  html, body {\n    margin: 0;\n    padding: 0;\n  }\n\n  html {\n    width: 100vw;\n    height: 100vh;\n  }\n\n  body {\n    width: 100%;\n    height: 100%;\n  }\n\n  #app {\n    width: ~\"calc(100% - 40px)\";\n    height: ~\"calc(100% - 40px)\";\n    padding: 20px 0 0 20px;\n  }\n\n  .container {\n    width: 100%;\n    height: ~\"calc(100% - 50px)\";\n    border: 1px solid black;\n  }\n\n  #contextMenu {\n    position: absolute;\n    z-index: 1000;\n    background: white;\n    border: 1px solid black;\n    padding: 5px;\n    margin: 0;\n\n    li {\n      &.label {\n        color: gray;\n        font-size: 90%;\n      }\n      list-style: none;\n    }\n\n    &:focus {\n      outline: none;\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","<template>\n  <div class=\"blocks-properties\">\n    <div class=\"property\" v-for=\"p in properties\">\n      <label :for=\"p.name\">{{p.label||p.name}}:</label>\n      <br>\n      <input type=\"text\" v-model=\"p.value\">\n    </div>\n    <button @click.prevent=\"save\">Save</button>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'VueBlockProperty',\n    props: ['property'],\n    data () {\n      return {\n        properties: []\n      }\n    },\n    methods: {\n      loadProperties () {\n        this.properties = this.property\n      },\n      save () {\n        this.$emit('save', this.properties)\n      }\n    },\n    watch: {\n      property () {\n        this.loadProperties()\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n  .blocks-properties {\n    position: absolute;\n    right: 0;\n    top: 0;\n\n    width: 300px;\n    min-height: 200px;\n    box-sizing: border-box;\n    padding: 10px;\n\n    background: #ffffff;\n    border: 1px solid red;\n    .property {\n\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/VueBlockProperty.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('VueBlocksContainer',{ref:\"container\",staticClass:\"container\",attrs:{\"blocksContent\":_vm.blocks,\"scene\":_vm.scene},on:{\"update:scene\":function($event){_vm.scene=$event},\"blockSelect\":_vm.selectBlock,\"blockDeselect\":_vm.deselectBlock},nativeOn:{\"contextmenu\":function($event){_vm.showContextMenu($event)},\"click\":function($event){_vm.closeContextMenu($event)}}}),_vm._v(\" \"),_c('VueBlockProperty',{attrs:{\"property\":_vm.selectedBlockProperty},on:{\"save\":_vm.saveProperty}}),_vm._v(\" \"),_c('label',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedType),expression:\"selectedType\"}],attrs:{\"name\":\"type\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedType=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_vm._l((_vm.selectBlocksType),function(type){return [_c('optgroup',{attrs:{\"label\":type}},_vm._l((_vm.filteredBlocks(type)),function(block){return _c('option',{domProps:{\"value\":block.name}},[_vm._v(_vm._s(block.title || block.name))])}))]})],2)]),_vm._v(\" \"),_c('button',{on:{\"click\":function($event){$event.stopPropagation();_vm.addBlock($event)}}},[_vm._v(\"Add\")]),_vm._v(\"\\n  |\\n  \"),_c('label',{attrs:{\"for\":\"useContextMenu\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.useContextMenu),expression:\"useContextMenu\"}],attrs:{\"type\":\"checkbox\",\"id\":\"useContextMenu\"},domProps:{\"checked\":Array.isArray(_vm.useContextMenu)?_vm._i(_vm.useContextMenu,null)>-1:(_vm.useContextMenu)},on:{\"change\":function($event){var $$a=_vm.useContextMenu,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.useContextMenu=$$a.concat([$$v]))}else{$$i>-1&&(_vm.useContextMenu=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.useContextMenu=$$c}}}}),_vm._v(\"Use right click for Add blocks\\n  \")]),_vm._v(\" \"),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.contextMenu.isShow),expression:\"contextMenu.isShow\"}],ref:\"contextMenu\",style:({top: _vm.contextMenu.top + 'px', left: _vm.contextMenu.left + 'px'}),attrs:{\"id\":\"contextMenu\",\"tabindex\":\"-1\"},on:{\"blur\":_vm.closeContextMenu}},[_vm._l((_vm.selectBlocksType),function(type){return [_c('li',{staticClass:\"label\"},[_vm._v(_vm._s(type))]),_vm._v(\" \"),_vm._l((_vm.filteredBlocks(type)),function(block){return _c('li',{on:{\"click\":function($event){_vm.addBlockContextMenu(block.name)}}},[_vm._v(_vm._s(block.title || block.name)+\"\\n      \")])})]})],2)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-689dded1\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-689dded1\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-689dded1\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}