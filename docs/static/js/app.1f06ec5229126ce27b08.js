webpackJsonp([1],{"9axT":function(t,e){},CTlh:function(t,e){},CVBE:function(t,e){},EQNY:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),s=n("mvHQ"),o=n.n(s),l=n("u0jV"),r=n("Gu7T"),a=n.n(r),c=n("BO1k"),u=n.n(c);function h(t){var e=t.getBoundingClientRect(),n=window.pageYOffset,i=window.pageXOffset,s=e.top+n,o=e.left+i;return{top:Math.round(s),left:Math.round(o)}}var d={getOffsetRect:h};var p={getMousePosition:function(t,e){var n=e.pageX||e.clientX+document.documentElement.scrollLeft,i=e.pageY||e.clientY+document.documentElement.scrollTop,s=h(t);return{x:n-s.left,y:i-s.top}}},m={name:"VueBlock",props:{x:{type:Number,default:0,validator:function(t){return"number"==typeof t}},y:{type:Number,default:0,validator:function(t){return"number"==typeof t}},selected:Boolean,title:{type:String,default:"Title"},inputs:Array,outputs:Array,options:{type:Object}},created:function(){this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.linking=!1,this.dragging=!1},mounted:function(){document.documentElement.addEventListener("mousemove",this.handleMove,!0),document.documentElement.addEventListener("mousedown",this.handleDown,!0),document.documentElement.addEventListener("mouseup",this.handleUp,!0)},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.handleMove,!0),document.documentElement.removeEventListener("mousedown",this.handleDown,!0),document.documentElement.removeEventListener("mouseup",this.handleUp,!0)},data:function(){return{width:this.options.width,hasDragged:!1}},methods:{handleMove:function(t){if(this.mouseX=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=t.pageY||t.clientY+document.documentElement.scrollTop,this.dragging&&!this.linking){var e=this.mouseX-this.lastMouseX,n=this.mouseY-this.lastMouseY;this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.moveWithDiff(e,n),this.hasDragged=!0}},handleDown:function(t){this.mouseX=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=t.pageY||t.clientY+document.documentElement.scrollTop,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var e=t.target||t.srcElement;this.$el.contains(e)&&1===t.which&&(this.dragging=!0,this.$emit("select"),t.preventDefault&&t.preventDefault())},handleUp:function(){this.dragging&&(this.dragging=!1,this.hasDragged&&(this.save(),this.hasDragged=!1)),this.linking&&(this.linking=!1)},slotMouseDown:function(t,e){this.linking=!0,this.$emit("linkingStart",e),t.preventDefault&&t.preventDefault()},slotMouseUp:function(t,e){this.$emit("linkingStop",e),t.preventDefault&&t.preventDefault()},slotBreak:function(t,e){this.linking=!0,this.$emit("linkingBreak",e),t.preventDefault&&t.preventDefault()},save:function(){this.$emit("update")},deleteBlock:function(){this.$emit("delete")},moveWithDiff:function(t,e){var n=this.x+t/this.options.scale,i=this.y+e/this.options.scale;this.$emit("update:x",n),this.$emit("update:y",i)}},computed:{style:function(){return{top:this.options.center.y+this.y*this.options.scale+"px",left:this.options.center.x+this.x*this.options.scale+"px",width:this.width+"px",transform:"scale("+this.options.scale+")",transformOrigin:"top left"}},headerStyle:function(){return{height:this.options.titleHeight+"px"}}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vue-block",class:{selected:t.selected},style:t.style},[n("header",{style:t.headerStyle},[t._v("\n    "+t._s(t.title)+"\n    "),n("a",{staticClass:"delete",on:{click:t.deleteBlock}},[t._v("x")])]),t._v(" "),n("div",{staticClass:"inputs"},t._l(t.inputs,function(e,i){return n("div",{staticClass:"input"},[n("div",{staticClass:"circle inputSlot",class:{active:e.active},on:{mouseup:function(e){t.slotMouseUp(e,i)},mousedown:function(e){t.slotBreak(e,i)}}}),t._v("\n      "+t._s(e.label)+"\n    ")])})),t._v(" "),n("div",{staticClass:"outputs"},t._l(t.outputs,function(e,i){return n("div",{staticClass:"output"},[n("div",{staticClass:"circle",class:{active:e.active},on:{mousedown:function(e){t.slotMouseDown(e,i)}}}),t._v("\n      "+t._s(e.label)+"\n    ")])}))])},staticRenderFns:[]};var v=n("VU/8")(m,f,!1,function(t){n("xF2k")},"data-v-9a4bcc94",null).exports,g={props:{lines:{type:Array,default:function(){return[]}},outline:{type:Boolean,default:!1}},methods:{distance:function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))},computeConnectionPoint:function(t,e,n,i,s){var o=this.distance(t,e,n,i),l=(1-s)*(1-s)*(1-s),r=(1-s)*(1-s)*3*s,a=3*(1-s)*(s*s),c=s*s*s;return{x:l*t+r*(t+.25*o)+a*(n-.25*o)+c*n,y:l*e+r*e+a*i+c*i}}},computed:{renderedPathes:function(){var t=this;if(!this.lines)return[];var e=[];return this.lines.forEach(function(n){var i=.25*t.distance(n.x1,n.y1,n.x2,n.y2);e.push({data:"M "+n.x1+", "+n.y1+" C "+(n.x1+i)+", "+n.y1+", "+(n.x2-i)+", "+n.y2+", "+n.x2+", "+n.y2,style:n.style,outlineStyle:n.outlineStyle})}),e},renderedArrows:function(){var t=this;if(!this.lines)return[];var e=[];return this.lines.forEach(function(n){var i=t.computeConnectionPoint(n.x1,n.y1,n.x2,n.y2,.5),s=t.computeConnectionPoint(n.x1,n.y1,n.x2,n.y2,.51),o=-Math.atan2(s.x-i.x,s.y-i.y),l=180*(o>=0?o:2*Math.PI+o)/Math.PI;e.push({transform:"translate("+i.x+", "+i.y+") rotate("+l+")",style:{stroke:n.style.stroke,strokeWidth:2*n.style.strokeWidth,fill:n.style.stroke}})}),e}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{width:"100%",height:"100%"}},[t._l(t.renderedPathes,function(e){return n("g",[t.outline?n("path",{style:e.outlineStyle,attrs:{d:e.data}}):t._e(),t._v(" "),n("path",{style:e.style,attrs:{d:e.data}})])}),t._v(" "),n("g",t._l(t.renderedArrows,function(t){return n("path",{style:t.style,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:t.transform}})}))],2)},staticRenderFns:[]};var k={name:"VueBlockContainer",components:{VueBlock:v,VueLink:n("VU/8")(g,y,!1,function(t){n("EQNY")},"data-v-56aa24a8",null).exports},props:{blocksContent:{type:Array,default:function(){return[]}},scene:{type:Object,default:{blocks:[],links:[],container:{}}},options:{type:Object}},mounted:function(){document.documentElement.addEventListener("mousemove",this.handleMove,!0),document.documentElement.addEventListener("mousedown",this.handleDown,!0),document.documentElement.addEventListener("mouseup",this.handleUp,!0),document.documentElement.addEventListener("wheel",this.handleWheel,!0),this.centerX=this.$el.clientWidth/2,this.centerY=this.$el.clientHeight/2,this.importBlocksContent(),this.importScene()},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.handleMove,!0),document.documentElement.removeEventListener("mousedown",this.handleDown,!0),document.documentElement.removeEventListener("mouseup",this.handleUp,!0),document.documentElement.removeEventListener("wheel",this.handleWheel,!0)},created:function(){this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.minScale=.2,this.maxScale=5,this.linking=!1,this.linkStartData=null,this.inputSlotClassName="inputSlot",this.defaultScene={blocks:[],links:[],container:{}}},data:function(){return{dragging:!1,centerX:0,centerY:0,scale:1,nodes:[],blocks:[],links:[],tempLink:null,selectedBlock:null,hasDragged:!1}},computed:{optionsForChild:function(){return{width:200,titleHeight:20,scale:this.scale,inputSlotClassName:this.inputSlotClassName,center:{x:this.centerX,y:this.centerY}}},container:function(){return{centerX:this.centerX,centerY:this.centerY,scale:this.scale}},lines:function(){var t=this,e=[],n=function(n){var i=t.blocks.find(function(t){return t.id===n.originID}),s=t.blocks.find(function(t){return t.id===n.targetID});if(!i||!s)return console.log("Remove invalid link",n),t.removeLink(n.id),"continue";if(i.id===s.id)return console.log("Loop detected, remove link",n),t.removeLink(n.id),"continue";var o=t.getConnectionPos(i,n.originSlot,!1),l=t.getConnectionPos(s,n.targetSlot,!0);if(!o||!l)return console.log("Remove invalid link (slot not exist)",n),t.removeLink(n.id),"continue";var r=o.x,a=o.y,c=l.x,u=l.y;e.push({x1:r,y1:a,x2:c,y2:u,style:{stroke:"#F85",strokeWidth:4*t.scale,fill:"none"},outlineStyle:{stroke:"#666",strokeWidth:6*t.scale,strokeOpacity:.6,fill:"none"}})},i=!0,s=!1,o=void 0;try{for(var l,r=u()(this.links);!(i=(l=r.next()).done);i=!0)n(l.value)}catch(t){s=!0,o=t}finally{try{!i&&r.return&&r.return()}finally{if(s)throw o}}return this.tempLink&&(this.tempLink.style={stroke:"#8f8f8f",strokeWidth:4*this.scale,fill:"none"},e.push(this.tempLink)),e}},methods:{handleMove:function(t){var e=p.getMousePosition(this.$el,t);if(this.mouseX=e.x,this.mouseY=e.y,this.dragging){var n=this.mouseX-this.lastMouseX,i=this.mouseY-this.lastMouseY;this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.centerX+=n,this.centerY+=i,this.hasDragged=!0}if(this.linking&&this.linkStartData){var s=this.getConnectionPos(this.linkStartData.block,this.linkStartData.slotNumber,!1);this.tempLink={x1:s.x,y1:s.y,x2:this.mouseX,y2:this.mouseY}}},handleDown:function(t){var e=t.target||t.srcElement;if((e===this.$el||e.matches("svg, svg *"))&&1===t.which){this.dragging=!0;var n=p.getMousePosition(this.$el,t);this.mouseX=n.x,this.mouseY=n.y,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.deselectAll(),t.preventDefault&&t.preventDefault()}},handleUp:function(t){var e=t.target||t.srcElement;this.dragging&&(this.dragging=!1,this.hasDragged&&(this.updateScene(),this.hasDragged=!1)),!this.$el.contains(e)||"string"==typeof e.className&&-1!==e.className.indexOf(this.inputSlotClassName)||(this.linking=!1,this.tempLink=null,this.linkStartData=null)},handleWheel:function(t){var e=t.target||t.srcElement;if(this.$el.contains(e)){t.preventDefault&&t.preventDefault();var n=Math.pow(1.1,-.01*t.deltaY);if(this.scale*=n,this.scale<this.minScale)return void(this.scale=this.minScale);if(this.scale>this.maxScale)return void(this.scale=this.maxScale);var i={x:this.mouseX,y:this.mouseY},s=(i.x-this.centerX)*(n-1),o=(i.y-this.centerY)*(n-1);this.centerX-=s,this.centerY-=o,this.updateScene()}},getConnectionPos:function(t,e,n){if(t&&-1!==e){var i=0,s=0;if(i+=t.x,s+=t.y,s+=this.optionsForChild.titleHeight,n&&t.inputs.length>e);else{if(n||!(t.outputs.length>e))return void console.error("slot "+e+" not found, is input: "+n,t);i+=this.optionsForChild.width}return s+=11,s+=16*e,i*=this.scale,s*=this.scale,{x:i+=this.centerX,y:s+=this.centerY}}},linkingStart:function(t,e){this.linkStartData={block:t,slotNumber:e};var n=this.getConnectionPos(this.linkStartData.block,this.linkStartData.slotNumber,!1);this.tempLink={x1:n.x,y1:n.y,x2:this.mouseX,y2:this.mouseY},this.linking=!0},linkingStop:function(t,e){if(this.linkStartData&&t&&e>-1){this.links=this.links.filter(function(n){return!(n.targetID===t.id&&n.targetSlot===e)});var n=Math.max.apply(Math,[0].concat(a()(this.links.map(function(t){return t.id}))));this.linkStartData.block.id!==t.id&&(this.links.push({id:n+1,originID:this.linkStartData.block.id,originSlot:this.linkStartData.slotNumber,targetID:t.id,targetSlot:e}),this.updateScene())}this.linking=!1,this.tempLink=null,this.linkStartData=null},linkingBreak:function(t,e){if(t&&e>-1){var n=this.links.find(function(n){return n.targetID===t.id&&n.targetSlot===e});if(n){var i=this.blocks.find(function(t){return t.id===n.originID});this.links=this.links.filter(function(n){return!(n.targetID===t.id&&n.targetSlot===e)}),this.linkingStart(i,n.originSlot),this.updateScene()}}},removeLink:function(t){this.links=this.links.filter(function(e){return!(e.id===t)})},addNewBlock:function(t,e,n){var i=Math.max.apply(Math,[0].concat(a()(this.blocks.map(function(t){return t.id})))),s=this.nodes.find(function(e){return e.name===t});if(s){var o=this.createBlock(s,i+1);void 0===e||void 0===n?(e=(this.$el.clientWidth/2-this.centerX)/this.scale,n=(this.$el.clientHeight/2-this.centerY)/this.scale):(e=(e-this.centerX)/this.scale,n=(n-this.centerY)/this.scale),o.x=e,o.y=n,this.blocks.push(o),this.updateScene()}},createBlock:function(t,e){var n=[],i=[],s={};return t.fields.forEach(function(t){if("input"===t.attr)n.push({name:t.name,label:t.label||t.name});else if("output"===t.attr)i.push({name:t.name,label:t.label||t.name});else{s[t.attr]||(s[t.attr]={});var e=Object(l.a)({},t);delete e.name,delete e.attr,s[t.attr][t.name]||(s[t.attr][t.name]={}),s[t.attr][t.name]=e}}),{id:e,x:0,y:0,selected:!1,name:t.name,title:t.title||t.name,inputs:n,outputs:i,values:s}},deselectAll:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.blocks.forEach(function(n){n.id!==e&&n.selected&&t.blockDeselect(n)})},blockSelect:function(t){t.selected=!0,this.selectedBlock=t,this.deselectAll(t.id),this.$emit("blockSelect",t)},blockDeselect:function(t){t.selected=!1,t&&this.selectedBlock&&this.selectedBlock.id===t.id&&(this.selectedBlock=null),this.$emit("blockDeselect",t)},blockDelete:function(t){var e=this;t.selected&&this.blockDeselect(t),this.links.forEach(function(n){n.originID!==t.id&&n.targetID!==t.id||e.removeLink(n.id)}),this.blocks=this.blocks.filter(function(e){return e.id!==t.id}),this.updateScene()},prepareBlocks:function(t){var e=this;return t.map(function(t){var n=e.nodes.find(function(e){return e.name===t.name});if(!n)return null;var i=e.createBlock(n,t.id);return i=Object(l.a)(i,t,{arrayMerge:function(t,e){return 0===e.length?t:e}})}).filter(function(t){return!!t})},prepareBlocksLinking:function(t,e){if(!t)return[];var n=[];return t.forEach(function(t){var i=e.filter(function(e){return e.targetID===t.id}),s=e.filter(function(e){return e.originID===t.id});t.inputs.forEach(function(e,n){t.inputs[n].active=i.some(function(t){return t.targetSlot===n})}),t.outputs.forEach(function(e,n){t.outputs[n].active=s.some(function(t){return t.originSlot===n})}),n.push(t)}),n},importBlocksContent:function(){this.blocksContent&&(this.nodes=Object(l.a)([],this.blocksContent))},importScene:function(){var t=this,e=Object(l.a)(this.defaultScene,this.scene),n=this.prepareBlocks(e.blocks);if(n=this.prepareBlocksLinking(n,e.links),this.selectedBlock){var i=n.find(function(e){return t.selectedBlock.id===e.id});i&&(i.selected=!0)}this.blocks=n,this.links=Object(l.a)([],e.links);var s=e.container;s.centerX&&(this.centerX=s.centerX),s.centerY&&(this.centerY=s.centerY),s.scale&&(this.scale=s.scale)},exportScene:function(){return{blocks:Object(l.a)([],this.blocks).map(function(t){return delete t.inputs,delete t.outputs,delete t.selected,t}),links:this.links,container:this.container}},updateScene:function(){this.$emit("update:scene",this.exportScene())}},watch:{blocksContent:function(){this.importBlocksContent()},scene:function(){this.importScene()}}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vue-container"},[n("VueLink",{attrs:{lines:t.lines}}),t._v(" "),t._l(t.blocks,function(e){return n("VueBlock",t._b({key:e.id,attrs:{options:t.optionsForChild},on:{update:t.updateScene,linkingStart:function(n){t.linkingStart(e,n)},linkingStop:function(n){t.linkingStop(e,n)},linkingBreak:function(n){t.linkingBreak(e,n)},select:function(n){t.blockSelect(e)},delete:function(n){t.blockDelete(e)}}},"VueBlock",e,!1,!0))})],2)},staticRenderFns:[]};var b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blocks-properties"},[t._l(t.properties,function(e){return n("div",{staticClass:"property"},[n("label",{attrs:{for:e.name}},[t._v(t._s(e.label||e.name)+":")]),t._v(" "),n("br"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"p.value"}],attrs:{type:"text"},domProps:{value:e.value},on:{input:function(n){n.target.composing||t.$set(e,"value",n.target.value)}}})])}),t._v(" "),n("button",{on:{click:function(e){e.preventDefault(),t.save(e)}}},[t._v("Save")])],2)},staticRenderFns:[]};var S={name:"App",components:{VueBlocksContainer:n("VU/8")(k,x,!1,function(t){n("9axT")},"data-v-cd11bc44",null).exports,VueBlockProperty:n("VU/8")({name:"VueBlockProperty",props:["property"],data:function(){return{properties:[]}},methods:{loadProperties:function(){this.properties=this.property},save:function(){this.$emit("save",this.properties)}},watch:{property:function(){this.loadProperties()}}},b,!1,function(t){n("CTlh")},"data-v-d11cfc5a",null).exports},data:function(){return{blocks:[{name:"text",title:"Text",family:"Animations",description:"Show text",fields:[{name:"text",label:"Text",type:"string",attr:"property"},{name:"delay",label:"Delay (s)",type:"number",attr:"property"},{name:"Show",type:"event",attr:"input"},{name:"Hide",type:"event",attr:"input"},{name:"onShow",type:"event",attr:"output"},{name:"onHide",type:"event",attr:"output"}]},{name:"animation",title:"Animation",family:"Animations",description:"Show animation",fields:[{name:"animation",label:"Animation",type:"animation",attr:"property"},{name:"Play",type:"event",attr:"input"},{name:"Stop",type:"event",attr:"input"},{name:"onEnd",type:"event",attr:"output"}]},{name:"Chat message",family:"Events",description:"",fields:[{name:"message",label:"Activation message",type:"string",attr:"property"},{name:"onMessage",type:"event",attr:"output"}]},{name:"delay",title:"Delay",family:"Time",description:"",fields:[{name:"delay",label:"Delay (s)",type:"number",attr:"property",value:1},{name:"input",type:"event",attr:"input"},{name:"output",type:"event",attr:"output"}]},{name:"shortcuts",title:"Shortcuts",family:"Events",description:"Press shortcut for call event",fields:[{name:"keys",label:"Activation keys",type:"keys",attr:"property"},{name:"onPress",type:"event",attr:"output"}]},{name:"splitter",title:"Splitter",family:"Helpers",description:"Press shortcut for call event",fields:[{name:"input",type:"event",attr:"input"},{name:"output",type:"event",attr:"output"},{name:"output",type:"event",attr:"output"},{name:"output",type:"event",attr:"output"},{name:"output",type:"event",attr:"output"}]}],scene:{blocks:[{id:2,x:-700,y:-69,name:"Chat message",title:"Chat message",values:{property:[{name:"message",type:"string"}]}},{id:4,x:-157,y:-68.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:5,x:136,y:-48.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:6,x:-440,y:-15.5,name:"delay",title:"Delay",values:{property:{delay:{label:"Delay (s)",type:"number",value:1}}}},{id:7,x:-694,y:60.5,name:"shortcuts",title:"Shortcuts",values:{property:{keys:{label:"Activation keys",type:"keys"}}}},{id:8,x:-163,y:59.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:9,x:-429,y:125.5,name:"delay",title:"Delay",values:{property:{delay:{label:"Delay (s)",type:"number",value:1}}}},{id:10,x:126,y:127.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:11,x:-856,y:252.5,name:"shortcuts",title:"Shortcuts",values:{property:{keys:{label:"Activation keys",type:"keys"}}}},{id:12,x:-616,y:319.5,name:"delay",title:"Delay",values:{property:{delay:{label:"Delay (s)",type:"number",value:1}}}},{id:13,x:-381,y:252.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:14,x:166,y:266.5,name:"text",title:"Text",values:{property:{text:{label:"Text",type:"string"}}}},{id:15,x:-149,y:269.5,name:"delay",title:"Delay",values:{property:{delay:{label:"Delay (s)",type:"number",value:1}}}},{id:16,x:413,y:267.5,name:"animation",title:"Animation",values:{property:{animation:{label:"Animation",type:"animation"}}}},{id:17,x:13,y:380.5,name:"delay",title:"Delay",values:{property:{delay:{label:"Delay (s)",type:"number",value:1}}}}],links:[{id:3,originID:2,originSlot:0,targetID:4,targetSlot:0},{id:6,originID:7,originSlot:0,targetID:8,targetSlot:0},{id:7,originID:7,originSlot:0,targetID:9,targetSlot:0},{id:8,originID:9,originSlot:0,targetID:10,targetSlot:0},{id:9,originID:9,originSlot:0,targetID:8,targetSlot:1},{id:10,originID:2,originSlot:0,targetID:6,targetSlot:0},{id:11,originID:6,originSlot:0,targetID:4,targetSlot:1},{id:12,originID:4,originSlot:1,targetID:5,targetSlot:0},{id:13,originID:11,originSlot:0,targetID:13,targetSlot:0},{id:14,originID:11,originSlot:0,targetID:12,targetSlot:0},{id:15,originID:12,originSlot:0,targetID:13,targetSlot:1},{id:16,originID:13,originSlot:1,targetID:15,targetSlot:0},{id:17,originID:15,originSlot:0,targetID:14,targetSlot:0},{id:18,originID:14,originSlot:0,targetID:16,targetSlot:0},{id:19,originID:14,originSlot:1,targetID:16,targetSlot:1},{id:20,originID:15,originSlot:0,targetID:17,targetSlot:0},{id:21,originID:17,originSlot:0,targetID:14,targetSlot:1}],container:{centerX:1042,centerY:140,scale:1}},selectedBlock:null,selectedType:"delay",useContextMenu:!0,contextMenu:{isShow:!1,mouseX:0,mouseY:0,top:0,left:0}}},computed:{selectedBlockProperty:function(){return this.selectedBlock&&this.selectedBlock.values&&this.selectedBlock.values.property?this.selectedBlock.values.property:null},selectBlocksType:function(){return this.blocks.map(function(t){return t.family}).filter(function(t,e,n){return n.indexOf(t)===e})}},methods:{selectBlock:function(t){console.log("select",t),this.selectedBlock=t},deselectBlock:function(t){console.log("deselect",t),this.selectedBlock=null},filteredBlocks:function(t){return this.blocks.filter(function(e){return e.family===t})},addBlock:function(){console.log(this.selectedType),this.$refs.container.addNewBlock(this.selectedType)},saveProperty:function(t){var e=this;console.log(t);var n=this.scene;n.blocks.find(function(t){return t.id===e.selectedBlock.id}).values.property=t,this.scene=Object(l.a)({},n)},showContextMenu:function(t){this.useContextMenu&&(t.preventDefault&&t.preventDefault(),this.contextMenu.isShow=!0,this.contextMenu.mouseX=t.x,this.contextMenu.mouseY=t.y,this.$nextTick(function(){this.setMenu(t.y,t.x),this.$refs.contextMenu.focus()}))},setMenu:function(t,e){var n=this.$refs.contextMenu,i=this.$refs.container.$el.getBoundingClientRect(),s=i.right-n.offsetWidth-5,o=i.bottom-n.offsetHeight-5;console.log(this.$refs.container),console.log(i),e>s&&(e=s),t>o&&(t=o),this.contextMenu.top=t,this.contextMenu.left=e},addBlockContextMenu:function(t){var e=d.getOffsetRect(this.$refs.container.$el),n=this.contextMenu.mouseX-e.left,i=this.contextMenu.mouseY-e.top;this.$refs.container.addNewBlock(t,n,i),this.closeContextMenu()},closeContextMenu:function(){this.contextMenu.isShow=!1}},watch:{blocks:function(t){console.log("blocks",o()(t))},scene:function(t){console.log("scene",o()(t))}}},D={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("VueBlocksContainer",{ref:"container",staticClass:"container",attrs:{blocksContent:t.blocks,scene:t.scene},on:{"update:scene":function(e){t.scene=e},blockSelect:t.selectBlock,blockDeselect:t.deselectBlock},nativeOn:{contextmenu:function(e){t.showContextMenu(e)},click:function(e){t.closeContextMenu(e)}}}),t._v(" "),n("VueBlockProperty",{attrs:{property:t.selectedBlockProperty},on:{save:t.saveProperty}}),t._v(" "),n("label",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedType,expression:"selectedType"}],attrs:{name:"type"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selectedType=e.target.multiple?n:n[0]}}},[t._l(t.selectBlocksType,function(e){return[n("optgroup",{attrs:{label:e}},t._l(t.filteredBlocks(e),function(e){return n("option",{domProps:{value:e.name}},[t._v(t._s(e.title||e.name))])}))]})],2)]),t._v(" "),n("button",{on:{click:function(e){e.stopPropagation(),t.addBlock(e)}}},[t._v("Add")]),t._v("\n  |\n  "),n("label",{attrs:{for:"useContextMenu"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.useContextMenu,expression:"useContextMenu"}],attrs:{type:"checkbox",id:"useContextMenu"},domProps:{checked:Array.isArray(t.useContextMenu)?t._i(t.useContextMenu,null)>-1:t.useContextMenu},on:{change:function(e){var n=t.useContextMenu,i=e.target,s=!!i.checked;if(Array.isArray(n)){var o=t._i(n,null);i.checked?o<0&&(t.useContextMenu=n.concat([null])):o>-1&&(t.useContextMenu=n.slice(0,o).concat(n.slice(o+1)))}else t.useContextMenu=s}}}),t._v("Use right click for Add blocks\n  ")]),t._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.contextMenu.isShow,expression:"contextMenu.isShow"}],ref:"contextMenu",style:{top:t.contextMenu.top+"px",left:t.contextMenu.left+"px"},attrs:{id:"contextMenu",tabindex:"-1"},on:{blur:t.closeContextMenu}},[t._l(t.selectBlocksType,function(e){return[n("li",{staticClass:"label"},[t._v(t._s(e))]),t._v(" "),t._l(t.filteredBlocks(e),function(e){return n("li",{on:{click:function(n){t.addBlockContextMenu(e.name)}}},[t._v(t._s(e.title||e.name)+"\n      ")])})]})],2)],1)},staticRenderFns:[]};var M=n("VU/8")(S,D,!1,function(t){n("CVBE")},null,null).exports;i.a.config.productionTip=!1,new i.a({el:"#app",components:{App:M},template:"<App/>"})},xF2k:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1f06ec5229126ce27b08.js.map